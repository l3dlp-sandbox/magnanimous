<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="icon" type="image/png" sizes="32x32" href="/magnanimous/images/ico/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/magnanimous/images/ico/favicon-16x16.png">
    <title>Using Components</title>
    <link rel="stylesheet" href="/magnanimous/css/styles.css">
    <link rel="stylesheet" href="/magnanimous/css/docs.css">
</head>
<div class="docs-top">
    <img src="/magnanimous/images/magnanimous-car-mini.jpg" width="60em" alt="Magnanimous Gopher">
    <span class="docs-link">
        <a href="/magnanimous/sections/docs.html">Magnanimous Documentation</a>
    </span>
</div>
<div class="main-body">

<h1>4. Using Components</h1>

<p>As you develop your website, you will notice that you will keep using similar patterns again and again
to create things like text boxes, data tables, dividers, and more obvious things like page headers and
footers.</p>

<p>To avoid repeating the same code all over the place, you can use Magnanimous components.</p>

<h2>Creating and using a component</h2>

<p>A component should be declared in a non-writable file (i.e. its name starts with underscore, as in <code>_example</code>)
somewhere under the <code>source/processed/</code> directory. That&rsquo;s because components are not usually full HTML pages,
but fragments which can be customized to display different content, sometimes even in a customizable shape
(so you wouldn&rsquo;t want them served by the server by themselves).</p>

<p>As an example, let&rsquo;s say we want to create a component to represent a simple <em>warning</em> box.</p>

<p>It could look like this:</p>
<pre style="background-color:#fff">{{ doc This component takes a &#39;message&#39; and displays it in a warning box }}\
<span style="color:#888">&lt;</span><span style="color:#2838b0">div</span> <span style="color:#388038">class</span><span style="color:#666">=</span><span style="color:#b83838">&#34;warning&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>{{ eval message }}<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">div</span><span style="color:#888">&gt;</span>
</pre>
<div class="file-box">source/processed/components/_warning.html</div>

<p>That&rsquo;s it!</p>

<p>You could then use this component in other files like this:</p>
<pre style="background-color:#fff"><span style="color:#888">&lt;</span><span style="color:#2838b0">div</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Some content<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">div</span><span style="color:#888">&gt;</span>

{{ component /processed/components/_warning.html }}
    Warning Box!! This text is ignored, only definitions in this scope are evaluated.
    {{ define message &#34;This is a warning message!&#34; }}
{{ end }}

<span style="color:#888">&lt;</span><span style="color:#2838b0">div</span><span style="color:#888"></span><span style="color:#888">&gt;</span>More content<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">div</span><span style="color:#888">&gt;</span>
</pre>
<blockquote>
<p>Notice that all customizable components must go in the <code>source/processed/</code> directory (so they can receive
  the customization via variables), but where under that directory does not matter for Magnanimous&hellip; they could
  go under any sub-directory you wish. If you create static components that don&rsquo;t need to be customized,
  you could even put them under <code>source/static</code>, which guarantees they will be included without changes.</p>
</blockquote>

<h3>Component scopes</h3>

<p>Notice that our example component expects a variable called <code>message</code> to exist in its scope. For that reason,
in the above example, we provide a <code>message</code> binding within the scope of the component itself, so that we don&rsquo;t
mess with the surrounding scope.</p>

<p>If that&rsquo;s not a concern, we could have just re-used an existing binding, as in this example:</p>
<pre style="background-color:#fff">{{ define message &#34;This is a warning message!&#34; }}\
<span style="color:#888">&lt;</span><span style="color:#2838b0">div</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Some content<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">div</span><span style="color:#888">&gt;</span>

{{ component /processed/components/_warning.html }}{{ end }}

<span style="color:#888">&lt;</span><span style="color:#2838b0">div</span><span style="color:#888"></span><span style="color:#888">&gt;</span>More content<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">div</span><span style="color:#888">&gt;</span>
</pre>
<p>Notice that the usual scope rules which apply to file inclusions also apply to components.</p>

<p>So, the <code>message</code> variable for the example component could even have come from another file which includes this file,
or ultimately, from the <code>_global_context</code>.</p>

<h3>A more advanced example</h3>

<p>To really understand what can be achieved with components, let&rsquo;s look at a more advanced example.</p>

<p>Let&rsquo;s create a data table which will contain a summary of the metadata for each file in a given directory.</p>

<p>This could be used as a table of contents, or blog post summary, for example.</p>

<p>First, we expect the <code>source/processed/posts/</code> directory to only contain files that declare the following variables:</p>

<ul>
<li><code>name</code></li>
<li><code>path</code></li>
<li><code>date</code></li>
</ul>

<p>To make things more concrete, here&rsquo;s what the files could look like:</p>
<pre style="background-color:#fff">{{ define name &#34;My first post&#34; }}\<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span>{{ define path &#34;/processed/posts/first_post.html&#34; }}\<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span>{{ define date &#34;2018-04-05&#34; }}\<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span><span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span><span style="color:#666">#</span> My first post
<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span>etc...<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span></pre>
<div class="file-box">source/processed/posts/first_post.md</div>
<pre style="background-color:#fff">{{ define name &#34;My second post&#34; }}\<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span>{{ define path baseURL + &#34;/processed/posts/second_post.html&#34; }}\<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span>{{ define date &#34;2018-06-07&#34; }}\<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span><span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span><span style="color:#666">#</span> My second post
<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span>etc...<span style="background-color:#a848a8">
</span><span style="background-color:#a848a8"></span></pre>
<div class="file-box">source/processed/posts/second_post.md</div>

<p>Now, we can define a simple HTML component that will put the posts&rsquo; metadata in a HTML table:</p>
<pre style="background-color:#fff">{{ doc
    Arguments:
      * dataDirectory - path to a directory containing files with the following properties:
          * name
          * path
          * date
}}\
<span style="color:#888">&lt;</span><span style="color:#2838b0">table</span> <span style="color:#388038">class</span><span style="color:#666">=</span><span style="color:#b83838">&#34;data-table-component&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">thead</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">th</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Post Date<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">th</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">th</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Post Name<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">th</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">thead</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">tbody</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
    {{ for post (sortBy date) eval dataDirectory }}\
    <span style="color:#888">&lt;</span><span style="color:#2838b0">tr</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
        <span style="color:#888">&lt;</span><span style="color:#2838b0">td</span><span style="color:#888"></span><span style="color:#888">&gt;</span>{{ eval post.date }}<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">td</span><span style="color:#888">&gt;</span>
        <span style="color:#888">&lt;</span><span style="color:#2838b0">td</span><span style="color:#888"></span><span style="color:#888">&gt;</span><span style="color:#888">&lt;</span><span style="color:#2838b0">a</span> <span style="color:#388038">href</span><span style="color:#666">=</span><span style="color:#b83838">&#34;{{ eval post.path }}&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>{{ eval post.name }}<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">a</span><span style="color:#888">&gt;</span><span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">td</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">tr</span><span style="color:#888">&gt;</span>
    {{ end }}\
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">tbody</span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">table</span><span style="color:#888">&gt;</span>
</pre>
<div class="file-box">source/processed/components/_data_table.html</div>

<p>Finally, we can add the component to our index page (and any other pages we want!):</p>
<pre style="background-color:#fff"><span style="color:#888">&lt;</span><span style="color:#2838b0">html</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#2838b0">body</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#2838b0">h2</span><span style="color:#888"></span><span style="color:#888">&gt;</span>These are my posts<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">h2</span><span style="color:#888">&gt;</span>
{{ component /processed/components/_data_table.html }}\
    {{ define dataDirectory &#34;/processed/posts&#34; }}\
{{ end }}\
<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">body</span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">html</span><span style="color:#888">&gt;</span>
</pre>
<div class="file-box">source/processed/index.html</div>

<p>And we&rsquo;re done!</p>

<p>Here&rsquo;s what the result should look like:</p>
<pre style="background-color:#fff"><span style="color:#888">&lt;</span><span style="color:#2838b0">html</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#2838b0">body</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#2838b0">h2</span><span style="color:#888"></span><span style="color:#888">&gt;</span>These are my posts<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">h2</span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#2838b0">table</span> <span style="color:#388038">class</span><span style="color:#666">=</span><span style="color:#b83838">&#34;data-table-component&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">thead</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">th</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Post Date<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">th</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">th</span><span style="color:#888"></span><span style="color:#888">&gt;</span>Post Name<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">th</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">thead</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">tbody</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">tr</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
        <span style="color:#888">&lt;</span><span style="color:#2838b0">td</span><span style="color:#888"></span><span style="color:#888">&gt;</span>2018-04-05<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">td</span><span style="color:#888">&gt;</span>
        <span style="color:#888">&lt;</span><span style="color:#2838b0">td</span><span style="color:#888"></span><span style="color:#888">&gt;</span><span style="color:#888">&lt;</span><span style="color:#2838b0">a</span> <span style="color:#388038">href</span><span style="color:#666">=</span><span style="color:#b83838">&#34;/processed/posts/first_post.html&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>My first post<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">a</span><span style="color:#888">&gt;</span><span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">td</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">tr</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#2838b0">tr</span><span style="color:#888"></span><span style="color:#888">&gt;</span>
        <span style="color:#888">&lt;</span><span style="color:#2838b0">td</span><span style="color:#888"></span><span style="color:#888">&gt;</span>2018-06-07<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">td</span><span style="color:#888">&gt;</span>
        <span style="color:#888">&lt;</span><span style="color:#2838b0">td</span><span style="color:#888"></span><span style="color:#888">&gt;</span><span style="color:#888">&lt;</span><span style="color:#2838b0">a</span> <span style="color:#388038">href</span><span style="color:#666">=</span><span style="color:#b83838">&#34;/processed/posts/second_post.html&#34;</span><span style="color:#888"></span><span style="color:#888">&gt;</span>My second post<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">a</span><span style="color:#888">&gt;</span><span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">td</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">tr</span><span style="color:#888">&gt;</span>
    <span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">tbody</span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">table</span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">body</span><span style="color:#888">&gt;</span>
<span style="color:#888">&lt;</span><span style="color:#888">/</span><span style="color:#2838b0">html</span><span style="color:#888">&gt;</span>
</pre>
<div class="file-box">target/index.html</div>

<p>Now, go on and create your own awesome components!</p>
</div>
<div class="footer">
    <div>
        <small>
            Back to <a href="/magnanimous/sections/docs.html">Documentation Home</a>
        </small>
    </div>
</div>
</body>
</html>